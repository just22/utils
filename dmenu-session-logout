#!/bin/sh

# ----------------------------------------------------------------------
#  $Id$
#
#  Logout from current session (or suspend/reboot/poweroff the machine)
#  using dmenu
# ----------------------------------------------------------------------

# No output msgs, please
exec >/dev/null 2>&1

MENU_ITEMS="\
Logout\n\
Suspend\n\
Hibernate\n\
Reboot\n\
Poweroff"

case "$(echo -e $MENU_ITEMS |
        dmenu-cust -p "Exit Session:" "$@")" in
Logout)
        if pgrep -x dwm; then
                pkill -x dwm
        elif pgrep -x fluxbox; then
                pkill -P "$(cat /tmp/dbar.pid)"
                rm /tmp/dbar.pid
                fluxbox-remote Exit
        elif pgrep -x cwm; then
                pkill -P "$(cat /tmp/dbar.pid)"
                rm /tmp/dbar.pid
                pkill -x cwm
        elif pgrep -x xfwm4; then
                xfce4-session-logout --logout --fast
        elif pgrep -x openbox; then
                openbox --exit
        else
                pkill -x twm
        fi
        ;;
Suspend)
        /usr/sbin/zzz
        ;;
Hibernate)
        /usr/sbin/ZZZ
        ;;
Reboot)
        /usr/bin/doas /sbin/reboot
        ;;
Poweroff)
        /usr/bin/doas /sbin/shutdown -p now
        ;;
esac

