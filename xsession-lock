#!/bin/sh

# ----------------------------------------------------------------------
#  $Id$
#
#  Typically used before suspend to RAM/disk operations:
#  - reset the screen (forcing LVDS only) and lock it;
#  - reset keyboard layout to "it".
# ----------------------------------------------------------------------

# No output msgs, please
exec >/dev/null 2>&1

# If Xfce4 is running, use xflock4
if pgrep -x xfce4-session; then
        xflock4
        exit 0
fi

# Restart xautolock
pkill -u $USER xautolock
xautolock -detectsleep -time 10 -locker slock &

# Reset keyboard layout
setxkbmap it

# Lock the screen
xautolock -locknow

# Force LVDS-only display layout
dmenu-xrandr LVDS

exit 0
