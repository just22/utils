#!/bin/sh

# ----------------------------------------------------------------------
#  $Id$
#
#  X display layout management with dual monitor configurations
# ----------------------------------------------------------------------

# No output msgs, please
exec >/dev/null 2>&1

# Clean up statusbar
if pkill -x bbpager; then
        restart_bbpager=1
fi
if pkill -x lemonbar; then
        restart_bar=1
fi
if pkill -x space_dapp; then
        restart_dock_spacer=1
fi
if pkill -x tint2; then
        restart_tint2=1
fi
if pgrep -x pcmanfm; then
        pcmanfm --desktop-off
        restart_pcmanfm_desktop=1
fi

# Change display layout
xrandr $@

# Restart window manager
if pgrep -x dwm; then
        [ -x ~/.fehbg ] && ~/.fehbg
elif pgrep -x jwm; then
        jwm -restart
elif pgrep -x fluxbox; then
        fluxbox-remote Restart
        fbsetbg -l
elif pgrep -x openbox; then
        xsetroot -solid rgb:58/6E/75
        openbox --restart
        [ -x ~/.fehbg ] && ~/.fehbg
elif pgrep -x fvwm2; then
        xsetroot -solid rgb:58/6E/75
        FvwmCommand Restart
        [ -x ~/.fehbg ] && ~/.fehbg
fi

[ "$restart_dock_spacer"      -eq 1 ] && space_dapp $((($(screen-width) - 166 - 1))) 15 &
[ "$restart_bar"              -eq 1 ] && dzen-dstat
[ "$restart_bbpager"          -eq 1 ] && (sleep 1 && bbpager) &
[ "$restart_tint2"            -eq 1 ] && tint2 &
[ "$restart_pcmanfm_desktop"  -eq 1 ] && pcmanfm --desktop &
